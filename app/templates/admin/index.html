{% extends 'admin/admin.html' %}
{% block css %}
    <link href="https://cdn.bootcss.com/highcharts/6.0.7/css/highcharts.css" rel="stylesheet">
{% endblock %}
{% block content %}
    <div class="wraper container-fluid">
        <div class="page-title">
            <h3 class="title">Welcome !</h3>
        </div>

        <div class="row">
            <div class="col-lg-6 col-sm-6">
                <div class="widget-panel widget-style-2 white-bg">
                    <i class="ion-arrow-graph-up-right text-purple"></i>
                    <h2 class="m-0 counter">{{ cost }}</h2>
                    <div>总费用</div>
                </div>
            </div>
            <div class="col-lg-6 col-sm-6">
                <div class="widget-panel widget-style-2 white-bg">
                    <i class="ion-android-contacts text-success"></i>
                    <h2 class="m-0 counter">{{ user_count }}</h2>
                    <div>用户数</div>
                </div>
            </div>
        </div> <!-- end row -->

        <!-- Line Chart -->
        <div class="row">
            <div class="col-sm-12">
                <div class="portlet"><!-- /primary heading -->
                    <div class="portlet-heading">
                        <h3 class="portlet-title text-dark">
                            近7天的报名费用情况
                        </h3>
                        <div class="portlet-widgets">
                            <a data-toggle="collapse" data-parent="#accordion1" href="#bg-default"><i
                                    class="ion-minus-round"></i></a>
                            <span class="divider"></span>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div id="bg-default" class="panel-collapse collapse in">
                        <div class="portlet-body">
                            <div id="myChart2" style="height: 300px;"></div>
                        </div>
                    </div>
                </div>
            </div> <!-- col -->
        </div>
        <!-- End Line Chart-->

        <div class="row">
            <div class="col-sm-12">
                <ul class="timeline">
                    <li>
                        <div class="timeline-badge success"><i class="fa fa-calendar"></i>
                            {#                            <i class="fa fa-check"></i>#}
                        </div>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                <h4 class="timeline-title">新闻操作动态</h4>
                                <hr>
                            </div>
                            <div class="timeline-body">
                                {% for oplog in oplog_news_list %}
                                    <p>
                                        <b>{{ loop.index }}.{{ oplog.admin.name }}</b>&nbsp;&nbsp;-->&nbsp;&nbsp;{{ oplog.opdetail }}<br>
                                        <b>操作时间：</b>&nbsp;&nbsp;{{ oplog.addtime }}
                                    </p>
                                {% endfor %}
                                <hr>
                                <a href="{{ url_for('admin.newsinfo_list') }}">More&gt;&gt;</a>
                            </div>
                        </div>
                    </li>

                    <li class="timeline-inverted">
                        <div class="timeline-badge warning"><i class="fa fa-tags"></i>
                        </div>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                <h4 class="timeline-title">考试操作动态</h4>
                                <hr>
                            </div>
                            <div class="timeline-body">
                                {% for oplog in oplog_test_list %}
                                    <p>
                                        <b>{{ loop.index }}.{{ oplog.admin.name }}</b>&nbsp;&nbsp;-->&nbsp;&nbsp;{{ oplog.opdetail }}<br>
                                        <b>操作时间：</b>&nbsp;&nbsp;{{ oplog.addtime }}
                                    </p>
                                {% endfor %}
                                <hr>
                                <a href="{{ url_for('admin.tinfo_list') }}">More&gt;&gt;</a>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="timeline-badge info"><i class="fa fa-book"></i>
                        </div>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                <h4 class="timeline-title">参考书操作动态</h4>
                                <hr>
                            </div>
                            <div class="timeline-body">
                                {% for oplog in oplog_book_list %}
                                    <p>
                                        <b>{{ loop.index }}.{{ oplog.admin.name }}</b>&nbsp;&nbsp;-->&nbsp;&nbsp;{{ oplog.opdetail }}<br>
                                        <b>操作时间：</b>&nbsp;&nbsp;{{ oplog.addtime }}
                                    </p>
                                {% endfor %}
                                <hr>
                                <a href="{{ url_for('admin.refbook_list') }}">More&gt;&gt;</a>
                            </div>
                        </div>
                    </li>
                    <li class="timeline-inverted">
                        <div class="timeline-badge success"><i class="fa fa-thumbs-up"></i>
                        </div>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                <h4 class="timeline-title">Start</h4>
                                <hr>
                            </div>
                            <div class="timeline-body">
                                <p>2018年1月29日星期一 16点05分，本系统开始编写</p>
                                <hr>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    </div>
{% endblock %}
{% block js %}
    <script src="https://cdn.bootcss.com/highcharts/6.0.7/highcharts.js"></script>
    <script src="https://cdn.bootcss.com/highcharts/6.0.7/js/modules/series-label.js"></script>
    <script src="https://cdn.bootcss.com/highcharts/6.0.7/js/modules/exporting.js"></script>

    <script>
        $(document).ready(function () {
            $("#g-1").addClass("active");
        });

        Highcharts.chart('myChart2', {
            title: {
                text: ''
            },
            credits: {
                enabled: false
            },
            xAxis: {
                categories: [
                    {% for chart in chart_list %}
                        '{{ chart[0] }}',
                    {% endfor %}
                ]
            },
            yAxis: {
                title: {
                    text: false
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },

            series: [{
                name: '费用',
                data: [
                    {% for chart in chart_list %}
                        {{ chart[1] }},
                    {% endfor %}
                ]
            }],

            responsive: {
                rules: [{
                    condition: {
                        maxWidth: 500
                    },
                    chartOptions: {
                        legend: {
                            layout: 'horizontal',
                            align: 'center',
                            verticalAlign: 'bottom'
                        }
                    }
                }]
            }

        });
    </script>
{% endblock %}